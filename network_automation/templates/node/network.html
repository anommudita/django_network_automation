

<!-- file dari config html -->
{% extends 'main.html' %}

<!-- load static -->
{% load static %}

<!-- wrapping content -->
{% block content %}

    <!-- flash message -->
    {% for message in messages %}
    <div class="container-fluid p-0">

        <div class="alert {{ message.tags }} alert-dismissible fade show col-6" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    </div>
    {% endfor %}

    <!-- tombol tambah -->
    <div class="col-lg-6 col-5 text-right mb-4">
        <a href="{% url 'detail-node' id_node=id_node %}" class="btn btn-outline-secondary fs-4">Back to Detail Node</a>
    </div>


    <div class="row">
        <div class="col">
        <!-- DataTales Example -->
            <div class="card flex-fill">
                <div class="card-header d-flex justify-content-between align-items-center">
                    {{network1}}
                    <h5 class="card-title mb-0">Data Network</h5>
                    <!-- dropdown -->
                        <div class="dropdown">
                            <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                                Insert
                            </button>
                            <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#addLinuxBridge">Linux Bridge</a></li>
                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#addLinuxBond">Linux Bond</a></li>
                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#addLinuxVlan">Linux VLAN</a></li>
                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#addOVSBridge">OVS Bridge</a></li>
                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#addOVSBond">OVS Bond</a></li>
                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#addOVSIntPort">OVS IntPort</a></li>
                                
                            </ul>
                        </div>
                </div>
                <table class="table table-hover my-0" id="dataTable" style="width: 100%">
                    <thead>
                        <tr>
                            <th class="d-none d-xl-table-cell" scope="col" width="5%">No</th>
                            <th class="d-none d-xl-table-cell" scope="col" width="15%">Name</th>
                            <th scope="col" width="10%">Type</th>
                            <th scope="col" width="10%">Active</th>
                            <th scope="col" width="15%">Address</th>
                            <th scope="col" width="15%">CIDR</th>
                            <th scope="col" width="15%">Gateway</th>
                            <th scope="col" width="20%">Aksi</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in network %}  
                            <tr>
                                <td class="no_urut">{{ forloop.counter }}</td>
                                <td>{{ row.iface }}</td>
                                <td>{{ row.type }}</td>  
                                <td>
                                    {% if row.active == 1 %}
                                        <span class="badge bg-success">Active</span>
                                    {% else %}
                                        <span class="badge bg-danger">Inactive</span>
                                    {% endif %}
                                </td>  
                                <td>{{ row.address }}</td> 
                                <td>{{ row.cidr }}</td>
                                <td>{{ row.gateway }}</td> 
                                <td>
                                    <a href="#" class="btn btn-success btnEdit" data-iface="{{row.iface}}" data-type="{{row.type}}" data-id_node="{{id_node}}">Edit</a>
                                    <a href="/delete-user/{{ row.userid }}" class="btn btn-danger delete-user">Delete</a>
                                </td>  
                            </tr>
                        {% endfor %} 
                    </tbody>
                </table>
            </div>
        </div>
    </div>

        <!-- modalbox edit linux bridge -->
        <div class="modal fade" id="editLinuxBridge" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="card bg-white border-0 mb-0">
                            <div class="card-header bg-transparent">
                                <h2 class="card-heading text-center"> Edit Linux Bridge</h2>
                            </div>

                            <!-- circles -->
                            <div style="text-align:center;margin-top:40px;">
                                <span class="step"></span>
                                <span class="step"></span>
                            </div>

                            <!-- card body -->
                            <div class="card-body">
                                <form action="" id="editFormLinuxBridge" method="post">
                                    {% csrf_token %}

                                    <!-- Tab 1 -->
                                    <div class="form-group mb-4 tab2">

                                        <!-- name interface -->
                                        <label for="edit_name">Name Interface : </label>
                                        <div class="input-group input-group-merge input-group-alternative">
                                        <div class="input-group-prepend">
                                            </div>
                                            <input class="form-control" name="edit_name" id="edit_name" placeholder="Enter Name Your Interface" type="text" autocomplete="off" value="">
                                        </div>
                                        <br>

                                        <!-- IPv4/CIDR -->
                                        <div class="form-group">
                                            <label for="edit_ipv4">IPv4 CIDR : </label>
                                            <div class="input-group input-group-merge input-group-alternative">
                                                <div class="input-group-prepend">
                                                    <span class="input-group-text">IPv4</span>
                                                </div>
                                                <input class="form-control" name="edit_ipv4" id="edit_ipv4" placeholder="Enter IP Address V4" type="text" autocomplete="off" value="">
                                                <div class="input-group-append">
                                                    <span class="input-group-text">/</span>
                                                </div>
                                                <input class="form-control" name="edit_netmask" id="edit_netmask" placeholder="Netmask" type="text" autocomplete="off" value="">
                                            </div>
                                        </div>


                                        <br>

                                        <!-- Gateaway CIDR4 -->
                                        <label for="edit_gateway_cidr4">Gateaway (IPv4) : </label>
                                        <div class="input-group input-group-merge input-group-alternative">
                                        <div class="input-group-prepend">
                                            </div>
                                            <input class="form-control" name="edit_gateway_cidr4" id="edit_gateway_cidr4" placeholder="Enter Gateaway IPv4" type="text" autocomplete="off" value="">
                                        </div>

                                        <br>

                                        <!-- IPv6/CIDR -->
                                        <label for="edit_ipv6">IPv6 CIDR : </label>
                                        <div class="input-group input-group-merge input-group-alternative">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">IPv6</span>
                                            </div>
                                            <input class="form-control" name="edit_ipv6" id="edit_ipv6" placeholder="Enter IP Address V6" type="text" autocomplete="off" value="">
                                            <div class="input-group-append">
                                                <span class="input-group-text">/</span>
                                            </div>
                                            <input class="form-control" name="edit_netmask6" id="edit_netmask6" placeholder="Netmask" type="number" autocomplete="off" value="">
                                        </div>

                                        <br>
                                        <!-- Gateaway CIDR6 -->
                                        <label for="edit_gateway_cidr6">Gateaway (IPv6) : </label>
                                        <div class="input-group input-group-merge input-group-alternative">
                                        <div class="input-group-prepend">
                                            </div>
                                            <input class="form-control" name="edit_gateway_cidr6" id="edit_gateway_cidr6" placeholder="Enter Gateaway IPv6" type="text" autocomplete="off" value="">
                                        </div>

                                        <br>
                                    </div>

                                    <!-- Tab 2 -->
                                    <div class="form-group mb-4 tab2">


                                        <!-- Bridge Port -->
                                        <label for="edit_bridgePort">Bridge Port : </label>
                                        <div class="input-group input-group-merge input-group-alternative">
                                        <div class="input-group-prepend">
                                            </div>
                                            <input class="form-control" name="edit_bridgePort" id="edit_bridgePort" placeholder="Enter Bridge Port" type="text" autocomplete="off" value="">
                                        </div>

                                        <br>

                                        <!-- Auto Start -->
                                        <div class="form-group mb-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="1" id="edit_autoStart" name="edit_autoStart" checked>
                                                <label class="form-check-label" for="edit_autoStart">
                                                    Auto Start
                                                </label>
                                            </div>
                                        </div>

                                        <!-- Vlan Aware -->
                                        <div class="form-group mb-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox"  id="edit_vlan_Aware" name="edit_vlan_Aware">
                                                <label class="form-check-label" for="editvlan_Aware">
                                                    Vlan Aware
                                                </label>
                                            </div>
                                        </div>

                                    </div>
                                    <div style="overflow:auto;">
                                        <div style="float:right;">
                                        <button class="btn btn-primary" type="button" id="prevBtn" onclick="nextPrev(-1)">Previous</button>
                                        <button class="btn btn-success" type="button" id="nextBtn" onclick="nextPrev(1)">Next</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
        </div>
        </div>
    <!-- end modalbox edit Linux bridge -->



    <!-- modalbox tambah linux bridge -->
        <div class="modal fade" id="addLinuxBridge" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="card bg-white border-0 mb-0">
                            <div class="card-header bg-transparent">
                                <h2 class="card-heading text-center">Linux Bridge</h2>
                            </div>

                            <!-- circles -->
                            <div style="text-align:center;margin-top:40px;">
                                <span class="step"></span>
                                <span class="step"></span>
                            </div>

                            <!-- card body -->
                            <div class="card-body">
                                <form action="{% url 'add-linux-bridge' id_node=id_node type='bridge' %}" id="addFormLinuxBridge" method="post">
                                    {% csrf_token %}

                                    <!-- Tab 1 -->
                                    <div class="form-group mb-4 tab">

                                        <!-- name interface -->
                                        <label for="name">Name Interface : </label>
                                        <div class="input-group input-group-merge input-group-alternative">
                                        <div class="input-group-prepend">
                                            </div>
                                            <input class="form-control" name="name" id="name" placeholder="Enter Name Your Interface" type="text" autocomplete="off" value="">
                                        </div>
                                        <br>

                                        <!-- IPv4/CIDR -->
                                        <div class="form-group">
                                            <label for="ipv4">IPv4 CIDR : </label>
                                            <div class="input-group input-group-merge input-group-alternative">
                                                <div class="input-group-prepend">
                                                    <span class="input-group-text">IPv4</span>
                                                </div>
                                                <input class="form-control" name="ipv4" id="ipv4" placeholder="Enter IP Address V4" type="text" autocomplete="off" value="">
                                                <div class="input-group-append">
                                                    <span class="input-group-text">/</span>
                                                </div>
                                                <input class="form-control" name="netmask" id="netmask" placeholder="Netmask" type="text" autocomplete="off" value="">
                                            </div>
                                        </div>


                                        <br>

                                        <!-- Gateaway CIDR4 -->
                                        <label for="gateway_cidr4">Gateaway (IPv4) : </label>
                                        <div class="input-group input-group-merge input-group-alternative">
                                        <div class="input-group-prepend">
                                            </div>
                                            <input class="form-control" name="gateway_cidr4" id="gateway_cidr4" placeholder="Enter Gateaway IPv4" type="text" autocomplete="off" value="">
                                        </div>

                                        <br>

                                        <!-- IPv6/CIDR -->
                                        <label for="ipv6">IPv6 CIDR : </label>
                                        <div class="input-group input-group-merge input-group-alternative">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">IPv6</span>
                                            </div>
                                            <input class="form-control" name="ipv6" id="ipv6" placeholder="Enter IP Address V6" type="text" autocomplete="off" value="">
                                            <div class="input-group-append">
                                                <span class="input-group-text">/</span>
                                            </div>
                                            <input class="form-control" name="netmask6" id="netmask6" placeholder="Netmask" type="number" autocomplete="off" value="">
                                        </div>

                                        <br>
                                        <!-- Gateaway CIDR6 -->
                                        <label for="gateway_cidr6">Gateaway (IPv6) : </label>
                                        <div class="input-group input-group-merge input-group-alternative">
                                        <div class="input-group-prepend">
                                            </div>
                                            <input class="form-control" name="gateway_cidr6" id="gateway_cidr6" placeholder="Enter Gateaway IPv6" type="text" autocomplete="off" value="">
                                        </div>

                                        <br>
                                    </div>

                                    <!-- Tab 2 -->
                                    <div class="form-group mb-4 tab">


                                        <!-- Bridge Port -->
                                        <label for="bridgePort">Bridge Port : </label>
                                        <div class="input-group input-group-merge input-group-alternative">
                                        <div class="input-group-prepend">
                                            </div>
                                            <input class="form-control" name="bridgePort" id="bridgePort" placeholder="Enter Bridge Port" type="text" autocomplete="off" value="">
                                        </div>

                                        <br>

                                        <!-- Auto Start -->
                                        <div class="form-group mb-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="1" id="autoStart" name="autoStart" checked>
                                                <label class="form-check-label" for="autoStart">
                                                    Auto Start
                                                </label>
                                            </div>
                                        </div>

                                        <!-- Vlan Aware -->
                                        <div class="form-group mb-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox"  id="vlan_Aware" name="vlan_Aware">
                                                <label class="form-check-label" for="vlan_Aware">
                                                    Vlan Aware
                                                </label>
                                            </div>
                                        </div>

                                    </div>
                                    <div style="overflow:auto;">
                                        <div style="float:right;">
                                        <button class="btn btn-primary" type="button" id="prevBtn" onclick="nextPrev(-1)">Previous</button>
                                        <button class="btn btn-success" type="button" id="nextBtn" onclick="nextPrev(1)">Next</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
        </div>
        </div>
    <!-- end modalbox tambah Linux bridge -->


    <!-- sweetalert2 -->
    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <script src="{% static 'plugins/sweetalert2/sweetalert2.all.min.js' %}"></script>
    <script src="{% static 'plugins/sweetalert2/myscript.js' %}"></script>

    <!-- scirpts ajax get data by iface -->
    <script>
        const myModal =  new bootstrap.Modal('#editLinuxBridge')
        $(document).ready(function($) {
            $(document).on('click', '.btnEdit', function() {
                var iface = $(this).data('iface');
                var type = $(this).data('type');
                var node = $(this).data('id_node');
                

                $.ajax({
                    method: 'GET',
                    url: '/data_api?action=view_data_network',
                    data: {
                        iface: iface,
                        type: type,
                        node: node,
                    },
                    success: function(res) {
                        if (res.data) {
                            var d = res.data;
                            // console.log(d);
                            $('#edit_firstname').val(d.firstname);
                            $('#edit_lastname').val(d.lastname);
                            $('#edit_email').val(d.email);
                            $('.edit_id').val(id);
                            var group = d.groups[0];
                            $('#edit_group').val(group);
                            myModal.show()
                        }
                    }
                });
            });
        
        });

        //  edit data user
        // document.getElementById("editFormUser").addEventListener("submit", function(event) {
        //     event.preventDefault(); // Prevent the default form submission
        //     var id = document.querySelector('.edit_id').value;
        //     var editForm = document.getElementById("editFormUser");
        //     editForm.action = '/edit-user/' + id; // Change the action URL
        //     editForm.submit(); // Submit the form
        // });
    </script>


    <!-- script multistep -->
    <script>
        var currentTab = 0; // Current tab is set to the first tab (0)
        showTab(currentTab); // Display the current tab

        function showTab(n) {
            // This function will display the specified tab of the form...
            var x = document.getElementsByClassName("tab");
            x[n].style.display = "block";
            // ... and fix the Previous/Next buttons:
            if (n == 0) {
                document.getElementById("prevBtn").style.display = "none";
            } else {
                document.getElementById("prevBtn").style.display = "inline";
            }
            if (n == (x.length - 1)) {
                document.getElementById("nextBtn").innerHTML = "Submit";
            } else {
                document.getElementById("nextBtn").innerHTML = "Next";
            }
            // ... and run a function that will display the correct step indicator:
            fixStepIndicator(n);
        }

        function nextPrev(n) {
            // This function will figure out which tab to display
            var x = document.getElementsByClassName("tab");

            // Exit the function if any field in the current tab is invalid:
            // if (n == 1 && !validateForm()) return false;
            // Hide the current tab:


            x[currentTab].style.display = "none";
            // Increase or decrease the current tab by 1:
            currentTab = currentTab + n;
            // if you have reached the end of the form...
            if (currentTab >= x.length) {
                // ... the form gets submitted:
                document.getElementById("addFormLinuxBridge").submit();
                return false;
            }
            // Otherwise, display the correct tab:
            showTab(currentTab);
        }

        function validateForm() {
            // This function deals with the validation of the form fields
            var x, y, i, valid = true;
            x = document.getElementsByClassName("tab");
            y = x[currentTab].getElementsByTagName("input");
            // A loop that checks every input field in the current tab:
            for (i = 0; i < y.length; i++) {
                // If a field is empty...
                if (y[i].value == "") {
                    // add an "invalid" class to the field:
                    y[i].className += " invalid";
                    // and set the current valid status to false
                    valid = false;
                }
            }
            // If the valid status is true, mark the step as finished and valid:
            if (valid) {
                document.getElementsByClassName("step")[currentTab].className += " finish";
            }
            return valid; // return the valid status
        }

        function fixStepIndicator(n) {
            // This function removes the "active" class of all steps...
            var i, x = document.getElementsByClassName("step");
            for (i = 0; i < x.length; i++) {
                x[i].className = x[i].className.replace(" active", "");
            }
            //... and adds the "active" class to the current step:
            x[n].className += " active";
        }
    </script>


{% endblock content %}


